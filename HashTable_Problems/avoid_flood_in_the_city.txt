Problem Name: Avoid Flood in The City

Solution Code:

class Solution {
    public int[] avoidFlood(int[] rains) {
        
        Map<Integer, Integer> full = new HashMap<>();  
        TreeSet<Integer> drain = new TreeSet<>();  
        int n = rains.length, res[] = new int[n];
        Arrays.fill(res, 1); 
        for (int i = 0; i < rains.length; i++) {
            int lake = rains[i];
            if (full.containsKey(lake)){
                Integer key = drain.ceiling(full.get(lake)); 
                if (key == null) return new int[]{};  
                res[key] = lake;  
                drain.remove(key); 
            }
            if (lake == 0) drain.add(i);  
            else {
                full.put(lake, i);
                res[i] = -1; 
            }
        }
        return res;
    }
}